
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://andy-utas.github.io/4-crystal/4-2-kspace/">
      
      <link rel="icon" href="../../logo.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.2">
    
    
      
        <title>Crystals in reciprocal space - Solid-state physics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="orange">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-tight-binding-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Solid-state physics" class="md-header__button md-logo" aria-label="Solid-state physics" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Solid-state physics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Crystals in reciprocal space
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Solid-state physics" class="md-nav__button md-logo" aria-label="Solid-state physics" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    Solid-state physics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../particulars/" class="md-nav__link">
        Course particulars
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        1: An introduction to solid-state physics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="1: An introduction to solid-state physics" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          1: An introduction to solid-state physics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../1-intoduction/1-1-specificheatI/" class="md-nav__link">
        1.1: The specific heat of solids I
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../1-intoduction/1-2-specificheatII/" class="md-nav__link">
        1.2: The specific heat of solids II
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../1-intoduction/1-3-emetalsI/" class="md-nav__link">
        1.3: Electrons in metals I
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../1-intoduction/1-4-emetalsII/" class="md-nav__link">
        1.4: Electrons in metals II
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../2-chemistry/2-1-chemistry/" class="md-nav__link">
        2: Chemistry 101
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        3: One-dimensional solids
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="3: One-dimensional solids" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          3: One-dimensional solids
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../3-1d/3-1-vibrations/" class="md-nav__link">
        3.1: Vibrations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../3-1d/3-2-diatomic/" class="md-nav__link">
        3.2: The diatomic chain
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../3-1d/3-3-tightbinding/" class="md-nav__link">
        3.3: The tight binding model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        4: Crystallography
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="4: Crystallography" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          4: Crystallography
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../4-1-realspace/" class="md-nav__link">
        Crystals
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Crystals in reciprocal space
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Crystals in reciprocal space
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reciprocal-lattice-motivation-1d-case" class="md-nav__link">
    Reciprocal lattice motivation 1D case
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-to-higher-dimensions" class="md-nav__link">
    Extending to higher dimensions
  </a>
  
    <nav class="md-nav" aria-label="Extending to higher dimensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2d-example-triangular-lattice" class="md-nav__link">
    2D example: triangular lattice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-lattice-example" class="md-nav__link">
    3D lattice example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-reciprocal-lattice-as-a-fourier-transform" class="md-nav__link">
    The reciprocal lattice as a Fourier transform
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#periodicity-of-the-reciprocal-lattice" class="md-nav__link">
    Periodicity of the reciprocal lattice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diffraction" class="md-nav__link">
    Diffraction
  </a>
  
    <nav class="md-nav" aria-label="Diffraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reciprocal-lattice-laue-conditions" class="md-nav__link">
    Reciprocal lattice: Laue conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure-factor" class="md-nav__link">
    Structure factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-primitive-unit-cell" class="md-nav__link">
    Non-primitive unit cell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powder-diffraction" class="md-nav__link">
    Powder Diffraction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#miller-planes" class="md-nav__link">
    Miller planes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    Conclusions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
    <nav class="md-nav" aria-label="Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preliminary-provocations" class="md-nav__link">
    Preliminary provocations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-1-equivalence-of-direct-and-reciprocal-lattice" class="md-nav__link">
    Exercise 1: Equivalence of direct and reciprocal lattice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-miller-planes-and-reciprocal-lattice-vectors" class="md-nav__link">
    Exercise 2: Miller planes and reciprocal lattice vectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-x-ray-scattering-in-2d" class="md-nav__link">
    Exercise 3: X-ray scattering in 2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-structure-factors-and-powder-diffraction" class="md-nav__link">
    Exercise 4: Structure factors and powder diffraction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-directions-and-spacings-of-miller-planes" class="md-nav__link">
    Exercise 3: Directions and Spacings of Miller planes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../4-3-diffraction/" class="md-nav__link">
        Diffraction
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        5: Electrons in solids
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="5: Electrons in solids" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          5: Electrons in solids
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Bloch theorem
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Band structure
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        6: Semiconductors
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="6: Semiconductors" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          6: Semiconductors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Semiconductors 101
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Doping and devices
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        7: Magnetism
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="7: Magnetism" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          7: Magnetism
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Empty content
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      <label class="md-nav__link" for="__nav_10">
        8: Cool stuff
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="8: Cool stuff" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          8: Cool stuff
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Topological insulators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Superconductors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../placeholder/" class="md-nav__link">
        Quantum simulators
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../additional/" class="md-nav__link">
        Additional resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reciprocal-lattice-motivation-1d-case" class="md-nav__link">
    Reciprocal lattice motivation 1D case
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-to-higher-dimensions" class="md-nav__link">
    Extending to higher dimensions
  </a>
  
    <nav class="md-nav" aria-label="Extending to higher dimensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2d-example-triangular-lattice" class="md-nav__link">
    2D example: triangular lattice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-lattice-example" class="md-nav__link">
    3D lattice example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-reciprocal-lattice-as-a-fourier-transform" class="md-nav__link">
    The reciprocal lattice as a Fourier transform
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#periodicity-of-the-reciprocal-lattice" class="md-nav__link">
    Periodicity of the reciprocal lattice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diffraction" class="md-nav__link">
    Diffraction
  </a>
  
    <nav class="md-nav" aria-label="Diffraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reciprocal-lattice-laue-conditions" class="md-nav__link">
    Reciprocal lattice: Laue conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure-factor" class="md-nav__link">
    Structure factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-primitive-unit-cell" class="md-nav__link">
    Non-primitive unit cell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powder-diffraction" class="md-nav__link">
    Powder Diffraction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#miller-planes" class="md-nav__link">
    Miller planes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    Conclusions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
    <nav class="md-nav" aria-label="Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preliminary-provocations" class="md-nav__link">
    Preliminary provocations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-1-equivalence-of-direct-and-reciprocal-lattice" class="md-nav__link">
    Exercise 1: Equivalence of direct and reciprocal lattice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-miller-planes-and-reciprocal-lattice-vectors" class="md-nav__link">
    Exercise 2: Miller planes and reciprocal lattice vectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-x-ray-scattering-in-2d" class="md-nav__link">
    Exercise 3: X-ray scattering in 2D
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-structure-factors-and-powder-diffraction" class="md-nav__link">
    Exercise 4: Structure factors and powder diffraction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-directions-and-spacings-of-miller-planes" class="md-nav__link">
    Exercise 3: Directions and Spacings of Miller planes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="the-tight-binding-model">The tight binding model<a class="headerlink" href="#the-tight-binding-model" title="Permanent link">&para;</a></h1>
<p>Learn the <em>reciprocal</em> secrets of crystals<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><img alt="" src="../images/4-2-kspaceheader.jpg" /></p>
<p>The model of Sommerfeld saw the Fermionic nature of electrons cemented in Drude's kinetic theory of electrons, but as we saw in our discussion of <a href="../../2-chemistry/2-1-chemistry">chemistry</a>, electrons tend not to be free, but rather occupy states as governed by surrounding nuclei. It is from this point that we aim to marry our discussion of bonding theory in the LCAO framework with our recent progress on modelling solids in one dimension.  </p>
<div class="admonition danger">
<p class="admonition-title">Expected competencies</p>
<p>It is assumed that you have familiarity with the following concepts/techniques:</p>
<ul>
<li>Solid-state physics: 1D model of a solid, LCAO</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Text reference</p>
<p>The material covered here is discussed in section(s) <script type="math/tex">\S 11</script> of <a href="https://global.oup.com/academic/product/the-oxford-solid-state-basics-9780199680771?cc=au&amp;lang=en&amp;">The Oxford Solid State Basics</a></p>
</div>
<div class="admonition info">
<p class="admonition-title">Computational content</p>
<p>The Jupyter notebook associated with this section can be accessed by clicking the icon below:
<a class="text-center" href="https://jove2021.cloud.edu.au/hub/user-redirect/git-pull?repo=https%3A%2F%2Fgithub.com%2FAndy-UTAS%2FSolid-state&amp;urlpath=tree%2FSolid-state%2F3-3-tightbinding.ipynb&amp;branch=master" style="margin-left: 45%"><i class="fab fa-python fa-5x"></i></a></p>
</div>
<hr />
<p><em>based on chapters 13.1-13.2 &amp; 14.1-14.2 of the book</em>  </p>
<div class="admonition success">
<p class="admonition-title">Expected prior knowledge</p>
<p>Before the start of this lecture, you should be able to:</p>
<ul>
<li>describe crystal structures using crystallographic terminology (lattice, basis, unit cells, etc. as introduced in the previous lecture)</li>
<li>recall that waves will interfere constructively or destructively depending on their relative phase</li>
<li>describe the basic concepts of the reciprocal space</li>
</ul>
</div>
<div class="admonition summary">
<p class="admonition-title">Learning goals</p>
<p>After this lecture you will be able to:</p>
<ul>
<li>Define the reciprocal space, and explain its relevance</li>
<li>Construct a reciprocal lattice from a given real space lattice</li>
<li>Compute the intensity of X-ray diffraction of a given crystal</li>
<li>Interpret X-ray powder diffraction data</li>
</ul>
</div>
<details class="info"><summary>Lecture video</summary><p><iframe width="100%" height="315" src="https://www.youtube-nocookie.com/embed/0l8Z0p07YeM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
</details>
<p>In the last lecture, we learned crystallographic terminology in order to describe crystal structures.
Now our goal is twofold, we will:
- Study what consequences does a lattice have in reciprocal space (with the goal of considering dispersion relations)
- Consider how to probe crystal structure using X-ray diffraction experiments.</p>
<h2 id="reciprocal-lattice-motivation-1d-case">Reciprocal lattice motivation 1D case<a class="headerlink" href="#reciprocal-lattice-motivation-1d-case" title="Permanent link">&para;</a></h2>
<p>In <a href="7_tight_binding.md">lecture 7</a> we discussed the reciprocal space of a simple 1D lattice.
To obtain the dispersion relation we considered waves of the form
<script type="math/tex; mode=display">
e^{ikx_n} = e^{ikna}, \quad n \in \mathbb{Z},
</script>
where <script type="math/tex">x_n = na</script> is the 1D lattice point.
We then observed that these waves with wave vectors <script type="math/tex">k</script> and <script type="math/tex">k+G</script>, where <script type="math/tex">G=2\pi m/a</script> with integer <script type="math/tex">m</script>, are exactly the same:</p>
<p>
<script type="math/tex; mode=display">
e^{i(k+G)na} = e^{ikna+im2\pi n} =  e^{ikna},
</script>
</p>
<p>where we used</p>
<p>
<script type="math/tex; mode=display">
e^{iGx_n} = e^{i2\pi mn} =  1.
</script>
</p>
<p>The set of points <script type="math/tex">G=2\pi m/a</script> forms the <strong>reciprocal lattice</strong>.
Let us now generalize the same idea to describe the reciprocal lattice in 3D.</p>
<h2 id="extending-to-higher-dimensions">Extending to higher dimensions<a class="headerlink" href="#extending-to-higher-dimensions" title="Permanent link">&para;</a></h2>
<p>We start from a lattice in real space:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{R}=n_1\mathbf{a}_1+n_2\mathbf{a}_2+n_3\mathbf{a}_1, \quad \{n_1, n_2, n_3\} \in \mathbb{Z},
</script>
</p>
<p>where <script type="math/tex">\mathbf{a}_1</script>, <script type="math/tex">\mathbf{a}_2</script> and <script type="math/tex">\mathbf{a}_3</script> are the lattice vectors.
The reciprocal lattice is also a lattice, but in the <script type="math/tex">k</script>-space:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{G}=m_1\mathbf{b}_1+m_2\mathbf{b}_2+m_3\mathbf{b_3}, \quad \{m_1, m_2, m_3\} \in \mathbb{Z}.
</script>
</p>
<p>The vectors <script type="math/tex">\mathbf{b}_1</script>, <script type="math/tex">\mathbf{b}_2</script> and <script type="math/tex">\mathbf{b}_2</script> are the <strong>reciprocal lattice vectors</strong>.
Let us now determine the reciprocal lattice vectors by requiring that waves that differ by a reciprocal lattice vector are indistinguishable.
In other words, we require that</p>
<p>
<script type="math/tex; mode=display">
e^{i\mathbf{k}\mathbf{R}} = e^{i(\mathbf{k} + \mathbf{G})\mathbf{R}},
</script>
</p>
<p>for any <script type="math/tex">\mathbf{R}</script> in the lattice.
Substituting the definitions of <script type="math/tex">\mathbf{R}</script> and <script type="math/tex">\mathbf{G}</script> we get</p>
<p>
<script type="math/tex; mode=display">
\mathrm{e}^{i\mathbf{G}\cdot\mathbf{R}} = \mathrm{e}^{i\sum_{\{i,j\}=1}^{3} n_i m_j \mathbf{a}_i \cdot \mathbf{b}_j}=1.
</script>
</p>
<p>This relation holds only if</p>
<p>
<script type="math/tex; mode=display">
\mathbf{a_i}\cdot\mathbf{b_j}=2\pi\delta_{ij}.
</script>
</p>
<p>Indeed, after expanding the dot products in the exponent, we get</p>
<p>
<script type="math/tex; mode=display">
\mathrm{e}^{i\mathbf{G}\cdot\mathbf{R}} = \mathrm{e}^{2\pi i(n_1 m_1 + n_2 m_2 + n_3 m_3)}.
</script>
</p>
<p>Because <script type="math/tex">n_i</script> and <script type="math/tex">m_j</script> are both integers, the exponent evaluates to 1.</p>
<p>The relation <script type="math/tex">\mathbf{a_i}\cdot\mathbf{b_j}=2\pi\delta_{ij}</script> means that if we write the lattice vectors as rows of a matrix, the reciprocal lattice vectors are <script type="math/tex">2\pi</script> times the columns of the inverse of that matrix.</p>
<h3 id="2d-example-triangular-lattice">2D example: triangular lattice<a class="headerlink" href="#2d-example-triangular-lattice" title="Permanent link">&para;</a></h3>
<p>In order to gain extra intuition of the properties of the reciprocal lattice, let us study a specific example.</p>
<p>In the previous lecture we studied the triangular lattice, which is shown in the figure below.
The left panel show the real-space lattice with lattice vectors <script type="math/tex">\mathbf{a}_1 = a \mathbf{\hat{x}}</script> and <script type="math/tex">\mathbf{a}_2 = a/2\mathbf{\hat{x}} + \sqrt{3}a/2 \mathbf{\hat{y}}</script>.
While the right panel shows the corresponding reciprocal lattice and its reciprocal lattice vectors <script type="math/tex">\mathbf{b}_1</script> and <script type="math/tex">\mathbf{b}_2</script>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define primitive lattice vectors</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># Compute reciprocal lattice vectors</span>
<span class="n">b1</span><span class="p">,</span><span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">shared_yaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Real Space&#39;</span><span class="p">,</span> <span class="s1">&#39;Reciprocal Space&#39;</span><span class="p">))</span>

<span class="c1"># Generates the lattice given the lattice vectors</span>
<span class="k">def</span> <span class="nf">lattice_generation</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">xGrid</span><span class="p">,</span> <span class="n">yGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">grid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">xGrid</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">a1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">yGrid</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">a2</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">subplot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">col</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">lat_points</span> <span class="o">=</span> <span class="n">lattice_generation</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
    <span class="n">line_a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">a1</span><span class="p">])</span>
    <span class="n">line_a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">a2</span><span class="p">])</span>
    <span class="n">dotLine_a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span><span class="n">a1</span><span class="o">+</span><span class="n">a2</span><span class="p">])</span>
    <span class="n">dotLine_a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">a2</span><span class="p">,</span><span class="n">a1</span><span class="o">+</span><span class="n">a2</span><span class="p">])</span>


    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">line_a1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">line_a1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
        <span class="p">),</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">line_a2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">line_a2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
        <span class="p">),</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">dotLine_a1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">dotLine_a1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span>
        <span class="p">),</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">dotLine_a2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">dotLine_a2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span>
        <span class="p">),</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lat_points</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">lat_points</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Black&#39;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="p">)</span>
        <span class="p">),</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
    <span class="p">)</span>

<span class="c1"># Generate subplots to be used by the slider</span>
<span class="n">N_values</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="n">N_values</span><span class="p">):</span>
    <span class="n">subplot</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">a2</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">subplot</span><span class="p">(</span><span class="n">b1</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="n">b2</span><span class="o">/</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Define the default subplot</span>
<span class="n">active</span> <span class="o">=</span> <span class="mi">4</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>   
    <span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">active</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_values</span><span class="p">):</span>
    <span class="n">step</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Lattice Constant&#39;</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;restyle&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)],</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">step</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Toggle i&#39;th trace to &quot;visible&quot;</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="n">sliders</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">tickcolor</span> <span class="o">=</span> <span class="s1">&#39;White&#39;</span><span class="p">,</span>
    <span class="n">font_color</span> <span class="o">=</span> <span class="s1">&#39;White&#39;</span><span class="p">,</span>
    <span class="n">currentvalue_font_color</span> <span class="o">=</span> <span class="s1">&#39;Black&#39;</span><span class="p">,</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">active</span><span class="p">,</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Lattice Constant&#39;</span><span class="p">,</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
<span class="p">)]</span>

<span class="c1"># Annotating lattice vectors</span>
<span class="k">def</span> <span class="nf">text_dict</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">ref</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;y1&#39;</span><span class="p">)):</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;xref&#39;</span> <span class="p">:</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;ayref&#39;</span> <span class="p">:</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;text&#39;</span> <span class="p">:</span> <span class="n">text</span><span class="p">,</span>
            <span class="s1">&#39;font&#39;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;size&#39;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="s1">&#39;color&#39;</span> <span class="p">:</span> <span class="s1">&#39;black&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;showarrow&#39;</span> <span class="p">:</span> <span class="kc">False</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">dic</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_plotly_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">fig</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">][</span><span class="s2">&quot;annotations&quot;</span><span class="p">]]</span>
<span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_dict</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{a}</span><span class="s1">_1$&#39;</span><span class="p">,(</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)))</span>
<span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_dict</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{a}</span><span class="s1">_2$&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.3</span><span class="p">)))</span>
<span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_dict</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{b}</span><span class="s1">_1$&#39;</span><span class="p">,(</span><span class="mf">0.8</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;y2&#39;</span><span class="p">)))</span>
<span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_dict</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{b}</span><span class="s1">_2$&#39;</span><span class="p">,(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">1.2</span><span class="p">),(</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;y2&#39;</span><span class="p">)))</span>
<span class="n">fig</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">][</span><span class="s2">&quot;annotations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span>


<span class="n">plot_range</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">sliders</span><span class="o">=</span><span class="n">sliders</span><span class="p">,</span>
    <span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span> <span class="o">=</span> <span class="s1">&#39;rgb(254, 254, 254)&#39;</span><span class="p">,</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">plot_range</span><span class="p">,</span><span class="n">plot_range</span><span class="p">],</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">showgrid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
      <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">plot_range</span><span class="p">,</span><span class="n">plot_range</span><span class="p">],</span>
      <span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
      <span class="n">showgrid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">plot_range</span><span class="p">,</span> <span class="n">plot_range</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>To find the reciprocal lattice vectors, we use the relation
<script type="math/tex; mode=display">
\mathbf{a_i}\cdot\mathbf{b_j}=2\pi\delta_{ij},
</script>
which gives us the following equations:
<script type="math/tex; mode=display">
\mathbf{a}_1\cdot\mathbf{b}_2=\mathbf{a}_2\cdot\mathbf{b}_1=0,
</script>
and
<script type="math/tex; mode=display">
\mathbf{a}_1\cdot\mathbf{b}_1=\mathbf{a}_2\cdot\mathbf{b}_2=2\pi.
</script>
We substitute <script type="math/tex">\mathbf{a_i}\cdot\mathbf{b_i} = \lvert \mathbf{a_i} \rvert \lvert \mathbf{b_i} \rvert \cos(\theta_i)</script>:
<script type="math/tex; mode=display">
\lvert \mathbf{a}_1 \rvert \lvert \mathbf{b}_1 \rvert =\frac{2\pi}{\cos(\theta_1)} \:\: \text{and} \:\: \lvert \mathbf{a}_2 \rvert \lvert \mathbf{b}_2 \rvert =\frac{2\pi}{\cos(\theta_2)},
</script>
where <script type="math/tex">\theta_i</script> is the angle between the vectors <script type="math/tex">\mathbf{a}_i</script> and <script type="math/tex">\mathbf{b}_i</script>.
To find the angles <script type="math/tex">\theta_1</script> and <script type="math/tex">\theta_2</script>, we use the orthogonality relations above and the fact that the angle between <script type="math/tex">\mathbf{a}_1</script> and <script type="math/tex">\mathbf{a}_2</script> is <script type="math/tex">60^\circ</script>.
From this we conclude that <script type="math/tex">\theta_1 = \theta_2 = 30^\circ</script>.
Because <script type="math/tex">\lvert \mathbf{a}_1 \rvert = \lvert \mathbf{a}_2 \rvert = a</script>, we find
<script type="math/tex; mode=display">
\lvert \mathbf{b}_1 \rvert = \lvert \mathbf{b}_2 \rvert = \frac{4\pi}{a\sqrt{3}}.
</script>
Unsurprisingly, we find that the lengths of the reciprocal lattice vectors are equal and inversely proportional to the lattice constant <script type="math/tex">a</script>.
With <script type="math/tex">\lvert \mathbf{b}_2 \rvert</script> and <script type="math/tex">\mathbf{a}_1 \perp \mathbf{b}_2</script>, we easily find
<script type="math/tex; mode=display">
\mathbf{b}_2 = \frac{4\pi}{a\sqrt{3}} \mathbf{\hat{y}}.
</script>
</p>
<p>We follow the same procedure to find <script type="math/tex">\mathbf{b}_1</script>:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{b}_1 = \frac{4\pi}{a\sqrt{3}} \left(\frac{\sqrt{3}}{2} \mathbf{\hat{x}} - \frac{1}{2}\mathbf{\hat{y}} \right).
</script>
</p>
<details class="question"><summary>Is the choice of a set of reciprocal lattice vectors unique? If not, which other ones are possible?</summary><p>There are many equivalent ways to choose lattice vectors of the reciprocal lattice. In the example above we could as well use
<script type="math/tex; mode=display">
\mathbf{b}_1 = \frac{4\pi}{a\sqrt{3}} \left(-\frac{\sqrt{3}}{2} \mathbf{\hat{x}} + \frac{1}{2}\mathbf{\hat{y}} \right) \quad \text{and} \quad \mathbf{b}_2 = -\frac{4\pi}{a\sqrt{3}} \mathbf{\hat{y}}.
</script>
There is however only one choice that satisfies the relations <script type="math/tex">\mathbf{a_i}\cdot\mathbf{b_j}=2\pi\delta_{ij}</script>.</p>
</details>
<h3 id="3d-lattice-example">3D lattice example<a class="headerlink" href="#3d-lattice-example" title="Permanent link">&para;</a></h3>
<p>Let us now consider a more involved example of the 3D lattice.
The explicit expression for the reciprocal lattice vectors in terms of their real space counterparts is:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{b}_1=\frac{2\pi(\mathbf{a}_2\times\mathbf{a}_3)}{ \mathbf{a}_1\cdot(\mathbf{a}_2\times\mathbf{a_3})}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\mathbf{b}_2=\frac{2\pi(\mathbf{a_3}\times\mathbf{a}_1)}{ \mathbf{a}_1\cdot(\mathbf{a}_2\times\mathbf{a_3})}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\mathbf{b_3}=\frac{2\pi(\mathbf{a}_1\times\mathbf{a}_2)}{ \mathbf{a}_1\cdot(\mathbf{a}_2\times\mathbf{a_3})}
</script>
</p>
<p>Note that the denominator <script type="math/tex">\mathbf{a}_1\cdot(\mathbf{a}_2\times\mathbf{a_3})</script> is the volume <script type="math/tex">V</script> of the real-space unit cell spanned by the lattice vectors <script type="math/tex">\mathbf{a}_1</script>, <script type="math/tex">\mathbf{a}_2</script> and <script type="math/tex">\mathbf{a}_3</script>.</p>
<h3 id="the-reciprocal-lattice-as-a-fourier-transform">The reciprocal lattice as a Fourier transform<a class="headerlink" href="#the-reciprocal-lattice-as-a-fourier-transform" title="Permanent link">&para;</a></h3>
<p>One can also think of the reciprocal lattice as a Fourier transform of the real-space lattice.
For simplicity, we illustrate this for a 1D lattice (the same principles apply to a 3D lattice).
We model the real-space lattice as a density function consisting of delta peaks:</p>
<p>
<script type="math/tex; mode=display">
\rho(x)=\sum_{n} \delta(x-na)
</script>
</p>
<p>We take the Fourier transform of this function to find:</p>
<p>
<script type="math/tex; mode=display">
{\mathcal F}_{k}\left[\rho(x)\right]=\int_{-\infty}^\infty \mathrm{d}x\ \mathrm{e}^{ikx} \rho(x)=\sum_{n} \int_{-\infty}^\infty \mathrm{d}x\ \mathrm{e}^{ikx} \delta(x-na)=\sum_{n} \mathrm{e}^{ikna}
</script>
</p>
<p>This sum is non-zero only if <script type="math/tex">k=2\pi m/a</script>.
If we recall the beginning of the lecture, then these points correspond to reciprocal lattice points <script type="math/tex">G</script>.
Therefore, we rewrite this into the form</p>
<p>
<script type="math/tex; mode=display">
{\mathcal F}_{k}\left[\rho(x)\right]=\frac{2\pi}{|a|}\sum_{m} \delta\left(k-G\right).
</script>
Therefore, we see that the Fourier transform is non-zero only at reciprocal lattice points.
In other words, Fourier transforming a real-space lattice yields a reciprocal lattice!
The above result generalizes directly to three dimensions:</p>
<p>
<script type="math/tex; mode=display">
{\mathcal F}_\mathbf{k}\left[\rho(\mathbf{r})\right]=\int \mathrm{d}\mathbf{r}\ \mathrm{e}^{i\mathbf{k}\cdot\mathbf{r}} \rho(\mathbf{r}) = \sum_\mathbf{G}\delta(\mathbf{k}-\mathbf{G}).
</script>
</p>
<h2 id="periodicity-of-the-reciprocal-lattice">Periodicity of the reciprocal lattice<a class="headerlink" href="#periodicity-of-the-reciprocal-lattice" title="Permanent link">&para;</a></h2>
<p>In order to describe a reciprocal lattice, we need to define a primitive unit cell in reciprocal space.
Previously, we learned that the choice of a primitive unit cell is not unique.
However, a general convention in reciprocal space is to use the Wigner-Seitz cell which is called the <strong>1st Brillouin zone</strong>.
Because the Wigner-Seitz cell is primitive, the 1st Brillouin zone (1BZ) contains a set of unique <script type="math/tex">\mathbf{k}</script> vectors.
This means that all <script type="math/tex">\mathbf{k}</script> vectors outside the 1st Brillouin zone are a copy of those inside the 1st Brillouin zone.
For example, any <script type="math/tex">\mathbf{k'}</script> outside the 1BZ is related to a wave vector inside 1BZ <script type="math/tex">\mathbf{k}</script> by shifting it by reciprocal lattice vectors: <script type="math/tex">\mathbf{k'} = \mathbf{k}+\mathbf{G}</script>
</p>
<p>We have already learned how to construct Wigner-Seitz cells, however here is a reminder of how a Brillouin zone looks like:</p>
<p><img alt="" src="figures/brillouin_mod.svg" /></p>
<h2 id="diffraction">Diffraction<a class="headerlink" href="#diffraction" title="Permanent link">&para;</a></h2>
<h3 id="reciprocal-lattice-laue-conditions">Reciprocal lattice: Laue conditions<a class="headerlink" href="#reciprocal-lattice-laue-conditions" title="Permanent link">&para;</a></h3>
<p>Reciprocal lattice manifests directly in the diffraction experiments.
A diffraction experiment uses the crystal as a target and scatters high energy particles (X-rays, neutrons, or electrons) off of it.
As a result of interference between mutiple waves, the scattered radiation reveals the reciprocal lattice of the crystal.
In order to find the relationship between the incoming wave and the scattered one, let us consider a lattice of atoms separated by a lattice vector <script type="math/tex">\mathbf{R}</script>.
An incoming wave with wave vector <script type="math/tex">\mathbf{k}</script> is incident upon the lattice.
After scattering, the outgoing wave's wave vector is <script type="math/tex">\mathbf{k'}</script>.
We assume that the atomic scattering is elastic (does not cause an energy loss), such that <script type="math/tex">|\mathbf{k'}|=|\mathbf{k}|</script>.
Below we present a simple sketch of two different atoms scattering an incoming wave.</p>
<p><img alt="" src="figures/scattering.svg" /></p>
<p>Observe that the bottom ray travels a larger distance compared to the upper ray.
The difference in distance results in a relative phase shift between the rays <script type="math/tex">\Delta \phi</script>.
With a bit of geometry, we find that the extra distance traveled by the lower ray relative to the upper one is</p>
<p>
<script type="math/tex; mode=display">
x_{\mathrm{extra}} = \Delta x_1+\Delta x_2 = \cos(\theta) \lvert R \rvert + \cos(\theta') \lvert R \rvert.
</script>
</p>
<p>As a result of the travel distance, the phase difference is:</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
\Delta \phi &= \lvert\mathbf{k} \rvert(\Delta x_1+\Delta x_2)\\
&= \lvert\mathbf{k}\rvert \lvert\mathbf{R}\rvert(\cos(\theta)+\cos(\theta'))\\
&= \mathbf{k'}\cdot \mathbf{R} - \mathbf{k}\cdot \mathbf{R} = (\mathbf{k'} - \mathbf{k}) \cdot \mathbf{R}.
\end{align}
</script>
</p>
<p>However, that is only a phase difference between waves scattered off of two atoms.
To find the outgoing wave's amplitude, we must sum over scattered waves from each and every atom in the lattice:</p>
<p>
<script type="math/tex; mode=display">
A\propto\sum_\mathbf{R}\mathrm{e}^{i\left(\Delta \phi-\omega t\right)} = \sum_\mathbf{R}\mathrm{e}^{i\left((\mathbf{k'}-\mathbf{k})\cdot\mathbf{R}-\omega t\right)}.
</script>
</p>
<p>The above sum is non-zero if and only if the scattered waves interfere constructively i.e. the phase difference equals <script type="math/tex">2\pi n</script>, where <script type="math/tex">n</script> is an integer.
Furthermore, we know that real and reciprocal lattice vectors are related by <script type="math/tex">\mathbf{G} \cdot \mathbf{R} = 2 \pi n</script>.
Therefore, we conclude that the difference between incoming and outgoing waves must be:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{k'}-\mathbf{k}=\mathbf{G}.
</script>
</p>
<p>In other words, if the difference of the wavevector between the incoming and outgoing wave vectors coïncides with a reciprocal lattice point, we expect constructive interference.
This requirement is known as the <em>Laue condition</em>.
As a result, the interference pattern produced in diffraction experiments is a direct measurement of the reciprocal lattice!</p>
<h3 id="structure-factor">Structure factor<a class="headerlink" href="#structure-factor" title="Permanent link">&para;</a></h3>
<p>Above we assumed that the unit cell contains only a single atom.
What if the basis contains more atoms though?
In the figure below we show a simple lattice which contains multiple atoms in the unit cell.
Note, the unit cell does not have to be primitive!</p>
<p><img alt="" src="figures/laue_mod.svg" /></p>
<p>Let <script type="math/tex">\mathbf{R}</script> be the lattice and let <script type="math/tex">\mathbf{R}+\mathbf{r}_j</script> be the location of the atoms in the unit cell.
The distance <script type="math/tex">\mathbf{r}_j</script> is taken with respect to lattice point from which we construct the unit cell.
Similar to before, we calculate the amplitude of the scattered wave.
However, now there are multiple atoms in the unit cell and each of these atoms acquires a phase shift of its own.
In order to keep track of the atoms, we define <script type="math/tex">\mathbf{r}_j</script> to be the location of atom <script type="math/tex">j</script> in the unit cell.
The distance <script type="math/tex">\mathbf{r}_j</script> is defined with respect to the lattice point from which we construct the unit cell.
In order to calculate the amplitude of the scattered wave, we must sum not only over all the lattice points but also over the atoms in a single unit cell:</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
A &\propto \sum_\mathbf{R} \sum_j f_j \mathrm{e}^{i\left(\mathbf{G}\cdot(\mathbf{R}+\mathbf{r}_j)-\omega t\right)}\\
&= \sum_\mathbf{R}\mathrm{e}^{i\left(\mathbf{G}\cdot\mathbf{R}-\omega t\right)}\sum_j f_j\ \mathrm{e}^{i\mathbf{G}\cdot\mathbf{r}_j}
\end{align}
</script>
</p>
<p>where <script type="math/tex">f_j</script> is the scattering amplitude off of a single atom, and it is called the <em>form factor</em>.
The form factor mainly depends on the chemical element, nature of the scattered wave, and finer details like the electrical environment of the atom.
The first part of the equation above is the familiar Laue condition, and it requires that the scattered wave satisfies the Laue condition.
The second part gives the amplitude of the scattered wave, and it is called the <strong>structure factor</strong>:</p>
<p>
<script type="math/tex; mode=display">
S(\mathbf{G})=\sum_j f_j\ \mathrm{e}^{i\mathbf{G}\cdot\mathbf{r}_j}.
</script>
</p>
<p>In diffraction experiments, the intensity of the scattered wave is <script type="math/tex">I \propto A^2</script>
Therefore, the intensity of a scattered wave depends on the structure factor <script type="math/tex">I \propto S(\mathbf{G})^2</script>.
Because the structure factor depends on the form factors and the positions of the basis atoms, by studying the visibility of different diffraction peaks we may learn the locations of atoms within the unit cell.</p>
<h3 id="non-primitive-unit-cell">Non-primitive unit cell<a class="headerlink" href="#non-primitive-unit-cell" title="Permanent link">&para;</a></h3>
<p>Laue conditions allow scattering as long as the scattering wave vector is a reciprocal lattice vector.
However if we consider a non-primitive unit cell of the direct lattice, the reciprocal lattice contains more lattice points, seemingly leading to additional interference peaks.
Computing the structure factor allows us to resolve this apparent contradiction.</p>
<details class="question"><summary>Calculate the structure factor in which there is a single atom the unit cell located at the lattice point. Do any diffraction peaks dissapear?</summary><p>
<script type="math/tex">\mathbf{r}_1=(0,0,0)\rightarrow S=f_1</script>.
In this case, each reciprocal lattice point gives one interference peak, none of which are absent.</p>
</details>
<p>As a demonstration of how it happens, let us compute the structure factor of the FCC lattice using the conventional unit cell in the real space.</p>
<p><img alt="" src="figures/fcc_mod.svg" /></p>
<p>The basis of the conventional FCC unit cell contains four identical atoms.
With respect to the reference lattice point, these attoms are located at</p>
<p>
<script type="math/tex; mode=display">
\begin{aligned}
\mathbf{r}_1&=(0,0,0)\\
\mathbf{r}_2&=\frac{1}{2}(\mathbf{a}_1+\mathbf{a}_2)\\
\mathbf{r}_3&=\frac{1}{2}(\mathbf{a}_2+\mathbf{a}_3)\\
\mathbf{r}_4&=\frac{1}{2}(\mathbf{a}_3+\mathbf{a}_1),
\end{aligned}
</script>
with <script type="math/tex">f_1=f_2=f_3=f_4\equiv f</script>. Let the reciprocal lattice be described by <script type="math/tex">\mathbf{G}=h\mathbf{b}_1+k\mathbf{b}_2+l\mathbf{b}_3</script>, where <script type="math/tex">h</script>, <script type="math/tex">k</script> and <script type="math/tex">l</script> are integers. Using the basis described above and the reciprocal lattice, we calculate the structure factor:</p>
<p>
<script type="math/tex; mode=display">
\begin{aligned}
S&=f\left(\mathrm{e}^{i\mathbf{G}\cdot\mathbf{r}_1}+\mathrm{e}^{i\mathbf{G}\cdot\mathbf{r}_2}+\mathrm{e}^{i\mathbf{G}\cdot\mathbf{r}_3}+\mathrm{e}^{i\mathbf{G}\cdot\mathbf{r}_4}\right)\\
&=f\left(1+\mathrm{e}^{i(h\mathbf{b}_1\cdot\mathbf{a}_1+k\mathbf{b}_2\cdot\mathbf{a}_2)/2}+\mathrm{e}^{i(k\mathbf{b}_2\cdot\mathbf{a}_2+l\mathbf{b}_3\cdot\mathbf{a}_3)/2}+\mathrm{e}^{i(h\mathbf{b}_1\cdot\mathbf{a}_1+l\mathbf{b}_3\cdot\mathbf{a}_3)/2}\right)\\
&=f\left(1+\mathrm{e}^{i\pi(h+k)}+\mathrm{e}^{i\pi(k+l)}+\mathrm{e}^{i\pi(h+l)}\right).
\end{aligned}
</script>
Because <script type="math/tex">h</script>, <script type="math/tex">k</script> and <script type="math/tex">l</script> are integers, all exponents are either <script type="math/tex">+1</script> or <script type="math/tex">-1</script>, and the interference is only present if</p>
<p>
<script type="math/tex; mode=display">
S =
\begin{cases}
    4f, \: \mathrm{if} \: h, \: k, \: \mathrm{and} \: l \: \mathrm{are \: all \: even \: or \: odd,}\\
    0, \: \mathrm{in \: all \: other \: cases}.
\end{cases}
</script>
We now see that the reciprocal lattice points with nonzero amplitude exactly form the reciprocal lattice of the FCC lattice.</p>
<h3 id="powder-diffraction">Powder Diffraction<a class="headerlink" href="#powder-diffraction" title="Permanent link">&para;</a></h3>
<p>The easiest way to do diffraction measurements is to take a crystal, shoot an X-ray beam through it and measure the direction of outgoing waves.
However growing a single crystal may be hard because many materials are polycrystalline</p>
<p>A simple alternative is to perform <strong>powder diffraction</strong>.
By crushing the crystal into a powder, the small crystallites are now orientated in random directions.
This improves the chances of fulfilling the Laue condition for a fixed direction incoming beam.
The experiment is illustrated in the figure above.
The result is that the diffracted beam exits the sample via concentric circles at discrete <strong>deflection angles</strong> <script type="math/tex">2 \theta</script>.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_patch</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">patches</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">patches</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">transform</span><span class="o">=</span><span class="n">mtransforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">skew_deg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
<span class="c1"># Create the screen</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">])</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span><span class="p">)</span>
<span class="n">circle_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">circle</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.08</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.22</span><span class="p">,</span><span class="mf">0.25</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
<span class="n">add_patch</span><span class="p">(</span><span class="n">ax</span><span class="p">,[</span><span class="n">rect</span><span class="p">]</span><span class="o">+</span><span class="n">circle_list</span><span class="p">)</span>

<span class="c1"># Add sample</span>
<span class="n">sample_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="o">-</span><span class="mf">0.6</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">sample_pos</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Powder Sample&#39;</span><span class="p">,</span><span class="n">sample_pos</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#Reference line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sample_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">],[</span><span class="n">sample_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1">#X-Ray Beam</span>
<span class="n">d_xray</span> <span class="o">=</span> <span class="n">sample_pos</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.05</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">d_xray</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;X-Ray Beam&#39;</span><span class="p">,(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.85</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">)</span>

<span class="c1"># Diffracted Beams</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="o">*</span><span class="n">sample_pos</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="o">*</span><span class="n">sample_pos</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.285</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>

<span class="c1">#Angle Arcs</span>
<span class="n">ellipse_radius</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Arc</span><span class="p">(</span><span class="n">sample_pos</span><span class="p">,</span> <span class="n">ellipse_radius</span><span class="p">,</span> <span class="n">ellipse_radius</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">theta1</span><span class="o">=</span><span class="mi">325</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$ 2</span><span class="se">\\</span><span class="s1">theta $&#39;</span><span class="p">,(</span><span class="o">-</span><span class="mf">0.56</span><span class="p">,</span><span class="o">-</span><span class="mf">0.44</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>In order to deduce the values of <script type="math/tex">\theta</script> of a specific crystal, let us put the Laue condition into a more practical form.
We first take the modulus squared of both sides:</p>
<p>
<script type="math/tex; mode=display">
\left|\mathbf{G}\right|^2 = \left|\mathbf{k'}-\mathbf{k} \right|^2 \\
G^2 =  2k^2-2\mathbf{k'} \cdot \mathbf{k},
</script>
</p>
<p>where we used <script type="math/tex">|\mathbf{k'}| = |\mathbf{k}|</script>.
We then substitute the Laue condition <script type="math/tex">\mathbf{k'} = \mathbf{k}+\mathbf{G}</script>:</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
\lvert \mathbf{G} \rvert ^2 &= 2k^2-2 \left(\mathbf{k}+\mathbf{G}\right) \cdot \mathbf{k} \\
&= -2 \mathbf{G} \cdot \mathbf{k}.
\end{align}
</script>
</p>
<p>Using <script type="math/tex">\mathbf{k} \cdot \mathbf{G} = \lvert \mathbf{k} \rvert \lvert \mathbf{G} \rvert \cos(\phi)</script>,  we obtain</p>
<p>
<script type="math/tex; mode=display">
\left| \mathbf{G} \right| = -2 \lvert \mathbf{k} \rvert \cos (\phi).
</script>
</p>
<p>Note, <script type="math/tex">\phi</script> is the angle between the vector <script type="math/tex">\mathbf{k}</script> and <script type="math/tex">\mathbf{G}</script>, which is not the same as the angle between the incoming and scattered waves <script type="math/tex">\theta</script>.
We are nearly there, but we are left with finding out the relation between <script type="math/tex">\phi</script> and <script type="math/tex">\theta</script>.</p>
<p>Recall the concept of Miller planes.
These are sets of planes identified by their Miller indices <script type="math/tex">(h,k,l)</script> which intersect the lattice vectors at <script type="math/tex">\mathbf{a}_1 / h</script>, <script type="math/tex">\mathbf{a}_22 / k</script> and <script type="math/tex">\mathbf{a}_3 / l</script>.
It turns out that Miller planes are normal to the reciprocal lattice vector <script type="math/tex">\mathbf{G} = h \mathbf{b}_1 + k \mathbf{b}_2 + l \mathbf{b}_3</script> and the distance between subsequent Miller planes is <script type="math/tex">d_{hkl} = 2 \pi/\lvert \mathbf{G} \rvert</script> (you will derive this in <a href="https://solidstate.quantumtinkerer.tudelft.nl/10_xray/#exercise-2-miller-planes-and-reciprocal-lattice-vectors">today's exercise</a>).
Substituting the expression for <script type="math/tex">\lvert \mathbf{G} \rvert</script> into the expression for the distance between Miller planes we get:</p>
<p>
<script type="math/tex; mode=display">
d_{hkl} \cos (\phi) = -\frac{\pi}{\lvert \mathbf{k} \rvert}.
</script>
</p>
<p>We know that <script type="math/tex">\lvert \mathbf{k} \rvert</script> is related to the wavelength by <script type="math/tex">\lvert \mathbf{k} \rvert = 2\pi/\lambda</script>.
Therefore, we can write the equation above as</p>
<p>
<script type="math/tex; mode=display">
2 d_{hkl} \cos (\phi) = -\lambda.
</script>
</p>
<p>Lastly, we express the equation in terms of the deflection angle through the relation <script type="math/tex">\phi = \theta + \pi/2</script>.
With this, one can finally derive <strong>Bragg's Law</strong>:</p>
<p>
<script type="math/tex; mode=display">
\lambda = 2 d_{hkl} \sin(\theta)
</script>
</p>
<p>Bragg's law allows us to obtain atomic distances in the crystal <script type="math/tex">d_{hkl}</script> through powder diffraction experiments!</p>
<h3 id="miller-planes">Miller planes<a class="headerlink" href="#miller-planes" title="Permanent link">&para;</a></h3>
<p>When fabricating crystals it is important to know both the orientation and the surface of the crystal.
Different cuts of a crystal lead to different surfaces.
In the chemical industry, this is especially significant because different surfaces lead to different chemical properties and thus is one of the foundations of research in catalysts.
Therefore, we seek a way to describe different planes of a crystal within our developed framework.
This leads us to a very important concept - <strong>Miller planes</strong>.
To explain Miller planes, let's start off with a simple cubic lattice:</p>
<p><img alt="" src="figures/cubic_mod.svg" /></p>
<p>Where <script type="math/tex">|{\bf a}_1|=|{\bf a}_2|=|{\bf a}_3|\equiv a</script>.</p>
<p>We can cut multiple planes through the cubic lattice.
Miller planes describe such planes with a set of indices.
The plane designated by Miller indices <script type="math/tex">(u,v,w)</script> intersects lattice vector <script type="math/tex">{\bf a}_1</script> at <script type="math/tex">\frac{|{\bf a}_1|}{u}</script>, <script type="math/tex">{\bf a}_2</script> at <script type="math/tex">\frac{|{\bf a}_2|}{v}</script> and <script type="math/tex">{\bf a}_3</script> at <script type="math/tex">\frac{|{\bf a}_3|}{w}</script>.</p>
<p><img alt="" src="figures/miller.svg" /></p>
<p>Miller index 0 means that the plane is parallel to that axis (intersection at "<script type="math/tex">\frac{|{\bf a}_3|}{0}\rightarrow\infty</script>"). A bar above a Miller index means intersection at a negative coordinate.</p>
<p>If a crystal is symmetric under <script type="math/tex">90^\circ</script> rotations, then <script type="math/tex">(100)</script>, <script type="math/tex">(010)</script> and <script type="math/tex">(001)</script> are physically indistinguishable.
Therefore, we use the notation <script type="math/tex">\{100\}</script> to indicate a whole family of these symmetry-related planes.
In a cubic crystal, <script type="math/tex">[100]</script> (this is a vector) is perpendicular to <script type="math/tex">(100)</script>
<script type="math/tex">\rightarrow</script> proof in problem set.</p>
<p>Why are these Miller planes usefull?
It allows us to know the exact orientation of a crystal structure if the crystal structure is known.</p>
<hr />
<h2 id="conclusions">Conclusions<a class="headerlink" href="#conclusions" title="Permanent link">&para;</a></h2>
<ul>
<li>We described how to construct a reciprocal lattice from a real-space lattice.</li>
<li>Points in reciprocal space that differ by a reciprocal lattice vector are equivalent.</li>
</ul>
<hr />
<h2 id="exercises">Exercises<a class="headerlink" href="#exercises" title="Permanent link">&para;</a></h2>
<h3 id="preliminary-provocations">Preliminary provocations<a class="headerlink" href="#preliminary-provocations" title="Permanent link">&para;</a></h3>
<ol>
<li>Calculate <script type="math/tex">\mathbf{a}_1 \cdot \mathbf{b}_1</script> and <script type="math/tex">\mathbf{a}_2 \cdot \mathbf{b}_1</script> using the definitions of the reciprocal lattice vectors given in the lecture. Is the result what you expected?</li>
<li>Why is the amplitude of a scattered wave zero if <script type="math/tex">\mathbf{k'}-\mathbf{k} \neq \mathbf{G}</script>?</li>
<li>Suppose we have a unit cell with a single atom in it.
Can any intensity peaks dissapear as a result of the structure factor?</li>
<li>Can increasing the unit cell in real space introduce new diffraction peaks due to reciprocal lattice having more points?</li>
</ol>
<h3 id="exercise-1-equivalence-of-direct-and-reciprocal-lattice">Exercise 1: Equivalence of direct and reciprocal lattice<a class="headerlink" href="#exercise-1-equivalence-of-direct-and-reciprocal-lattice" title="Permanent link">&para;</a></h3>
<p>The volume of a primitive cell of a lattice with lattice vectors <script type="math/tex">\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3</script>
<a href="https://en.wikipedia.org/wiki/Parallelepiped#Volume">equals</a> <script type="math/tex">V = |\mathbf{a}_1\cdot(\mathbf{a}_2\times\mathbf{a}_3)|</script>.</p>
<ol>
<li>Find the volume of a primitive unit cell <script type="math/tex">V^* = \left| \mathbf{b}_1 \cdot (\mathbf{b}_2 \times \mathbf{b}_3) \right|</script> of the corresponding reciprocal lattice.</li>
<li>
<p>Derive the expressions for the lattice vectors <script type="math/tex">\mathbf{a}_i</script> through the reciprocal lattice <script type="math/tex">\mathbf{b}_i</script>.</p>
<details class="hint"><summary>Hint</summary><p>Make use of the vector identity
<script type="math/tex; mode=display">\mathbf{A}\times(\mathbf{B}\times\mathbf{C}) = \mathbf{B}(\mathbf{A}\cdot\mathbf{C}) - \mathbf{C}(\mathbf{A}\cdot\mathbf{B})</script>
</p>
</details>
</li>
<li>
<p>Write down the primitive lattice vectors of the <a href="https://solidstate.quantumtinkerer.tudelft.nl/test_builds/lecture_9/9_crystal_structure/#body-centered-cubic-lattice">BCC lattice</a> and calculate its reciprocal lattice vectors.
Which type of lattice is the reciprocal lattice of a BCC crystal?</p>
</li>
<li>Determine the shape of the 1st Brillouin zone.</li>
</ol>
<h3 id="exercise-2-miller-planes-and-reciprocal-lattice-vectors">Exercise 2: Miller planes and reciprocal lattice vectors<a class="headerlink" href="#exercise-2-miller-planes-and-reciprocal-lattice-vectors" title="Permanent link">&para;</a></h3>
<p>Consider a family of Miller planes <script type="math/tex">(hkl)</script> in a crystal.</p>
<ol>
<li>
<p>Prove that the reciprocal lattice vector <script type="math/tex">\mathbf{G} = h \mathbf{b}_1 + k \mathbf{b}_2 + l \mathbf{b}_3</script> is perpendicular to the Miller plane <script type="math/tex">(hkl)</script>.</p>
<details class="hint"><summary>Hint</summary><p>Choose two vectors that lie within the Miller plane and are not parallel to each other.</p>
</details>
</li>
<li>
<p>Show that the distance between two adjacent Miller planes <script type="math/tex">(hkl)</script> of any lattice is  <script type="math/tex">d = 2\pi/|\mathbf{G}_\textrm{min}|</script>, where <script type="math/tex">\mathbf{G}_\textrm{min}</script> is the shortest reciprocal lattice vector perpendicular to these Miller planes.</p>
</li>
<li>Find the family of Miller planes of the BCC lattice that has the highest density of lattice points. To solve this problem use that the density of lattice points per unit area on a Miller plane is <script type="math/tex">\rho = d/V</script>. Here <script type="math/tex">V</script> is the volume of the primitive unit cell and <script type="math/tex">d</script> is the distance between adjacent planes given in 2.2.</li>
</ol>
<h3 id="exercise-3-x-ray-scattering-in-2d">Exercise 3: X-ray scattering in 2D<a class="headerlink" href="#exercise-3-x-ray-scattering-in-2d" title="Permanent link">&para;</a></h3>
<p><em>(adapted from ex 14.1 and ex 14.3 of "The Oxford Solid State Basics" by S.Simon)</em></p>
<p>Consider a two-dimensional crystal with a rectangular lattice and lattice vectors <script type="math/tex">\mathbf{a}_1 = (0.468, 0)</script> nm and <script type="math/tex">\mathbf{a}_2 = (0, 0.342)</script> nm (so that <script type="math/tex">\mathbf{a}_1</script> points along <script type="math/tex">x</script>-axis and <script type="math/tex">\mathbf{a}_2</script> points along <script type="math/tex">y</script>-axis).</p>
<ol>
<li>Sketch the reciprocal lattice of this crystal.</li>
<li>Consider an X-ray diffraction experiment performed on this crystal using monochromatic X-rays with wavelength <script type="math/tex">0.166</script> nm. By assuming elastic scattering, find the magnitude of the wave vectors of the incident and reflected X-ray beams.</li>
<li>On the reciprocal lattice sketched in 3.1, draw the "scattering triangle" corresponding to the diffraction from (210) planes. To do that use the Laue condition <script type="math/tex">\Delta \mathbf{k} = \mathbf{G}</script> for the constructive interference of diffracted beams.</li>
</ol>
<h3 id="exercise-4-structure-factors-and-powder-diffraction">Exercise 4: Structure factors and powder diffraction<a class="headerlink" href="#exercise-4-structure-factors-and-powder-diffraction" title="Permanent link">&para;</a></h3>
<ol>
<li>Compute the structure factor <script type="math/tex">\mathbf{S}</script> of the BCC lattice.</li>
<li>Which diffraction peaks are missing?</li>
<li>How does this structure factor change if the atoms in the center of the conventional unit cell have a different form factor from the atoms at the corner of the conventional unit cell?</li>
<li>A student carried out X-ray powder diffraction on Chromium (Cr) which is known to have a BCC structure. The first five diffraction peaks are given below. Furthermore, the student took the liberty of assigning Miller indices to the peaks. Were the peaks assigned correctly? Fix any mistakes and explain your reasoning.
<img alt="" src="figures/cr_xray_exercise.svg" /></li>
<li>Calculate the lattice constant, <script type="math/tex">a</script>, of the chromium bcc unit cell. Note that X-ray diffraction was carried out using Cu K-<script type="math/tex">\alpha</script> (<script type="math/tex">1.5406 \unicode{xC5}</script>) radiation.</li>
</ol>
<h3 id="exercise-3-directions-and-spacings-of-miller-planes">Exercise 3: Directions and Spacings of Miller planes<a class="headerlink" href="#exercise-3-directions-and-spacings-of-miller-planes" title="Permanent link">&para;</a></h3>
<p><em>(adapted from ex 13.3 of "The Oxford Solid State Basics" by S.Simon)</em></p>
<ol>
<li>Explain what is meant by the terms Miller planes and Miller indices.</li>
<li>Consider a cubic crystal with one atom in the basis and a set of orthogonal primitive lattice vectors <script type="math/tex">a\hat{x}</script>, <script type="math/tex">a\hat{y}</script> and <script type="math/tex">a\hat{z}</script>. Show that the direction <script type="math/tex">[hkl]</script> in this crystal is normal to the planes with Miller indices <script type="math/tex">(hkl)</script>.</li>
<li>Show that this is not true in general. Consider for instance an orthorhombic crystal, for which the primitive lattice vectors are still orthogonal but have different lengths.</li>
<li>
<p>Any set of Miller indices corresponds to a family of planes separated by a distance <script type="math/tex">d</script>. Show that the spacing <script type="math/tex">d</script> of the <script type="math/tex">(hkl)</script> set of planes in a cubic crystal with lattice parameter <script type="math/tex">a</script> is <script type="math/tex">d = \frac{a}{\sqrt{h^2 + k^2 + l^2}}</script>.</p>
<details class="hint"><summary>Hint</summary><p>Recall that a family of lattice planes is an infinite set of equally separated parallel planes which taken all together contain all points of the lattice.</p>
<p>Try computing the distance between the plane that contains the site <script type="math/tex">(0,0,0)</script> of the conventional unit cell and a plane defined by the <script type="math/tex">(hkl)</script> indices.</p>
</details>
</li>
</ol>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>This is only funny if you noticed the <a href="../../4-crystal/4-1-realspace/#crystal-structure">tagline of the previous section</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../4-1-realspace/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Crystals" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Crystals
            </div>
          </div>
        </a>
      
      
        
        <a href="../4-3-diffraction/" class="md-footer__link md-footer__link--next" aria-label="Next: Diffraction" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Diffraction
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Content prepared and curated by <a href="mailto:andrew.mcculloch@utas.edu.au">A J McCulloch</a>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.2b46852b.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="https://unpkg.com/thebelab@0.5.0/lib/index.js"></script>
      
        <script src="../../scripts/mathjaxhelper.js"></script>
      
        <script src="../../scripts/thebelabhelper.js"></script>
      
        <script src="../../scripts/x3dom.js"></script>
      
    
  </body>
</html>